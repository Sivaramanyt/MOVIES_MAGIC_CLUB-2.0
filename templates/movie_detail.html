{% extends "base.html" %}

{% block content %}
<style>
  .detail-shell {
    max-width: 960px;
    margin: 12px auto 0;
    display: flex;
    flex-direction: column;
    gap: 16px;
    font-size: 13px;
  }
  .card {
    background: rgba(15, 23, 42, 0.96);
    border-radius: 24px;
    border: 1px solid rgba(148, 163, 184, 0.5);
    padding: 14px 14px 16px;
  }
  .hero-layout {
    display: grid;
    grid-template-columns: minmax(0, 1.05fr) minmax(0, 1.3fr);
    gap: 14px;
    align-items: stretch;
  }
  .poster-wrap {
    border-radius: 22px;
    overflow: hidden;
    background: radial-gradient(circle at top, #1d4ed8, #020617);
  }
  .poster-wrap img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }
  .meta-main {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }
  .title {
    font-size: 20px;
    font-weight: 650;
  }
  .meta-line {
    font-size: 12px;
    color: var(--text-muted);
  }
  .pill-row {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-top: 4px;
  }
  .pill {
    padding: 6px 12px;
    border-radius: 999px;
    font-size: 11px;
    border: 1px solid rgba(55, 65, 81, 0.9);
    background: #020617;
  }
  .pill-accent {
    border-color: rgba(248, 113, 113, 0.9);
    color: #fecaca;
    background: rgba(127, 29, 29, 0.6);
  }
  .pill-secondary {
    border-color: rgba(59, 130, 246, 0.8);
    color: #93c5fd;
    background: rgba(29, 78, 216, 0.4);
  }
  .cta-row {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-top: 8px;
  }
  .btn-watch,
  .btn-download {
    flex: 1 1 140px;
    padding: 12px 16px;
    border-radius: 999px;
    text-align: center;
    font-weight: 600;
    font-size: 13px;
    text-decoration: none;
    transition: all 0.2s;
  }
  .btn-watch {
    background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
    color: #fff;
  }
  .btn-watch:hover {
    transform: scale(1.03);
    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
  }
  .btn-download {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    color: #fff;
  }
  .btn-download:hover {
    transform: scale(1.03);
    box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
  }
  .section-head {
    font-size: 14px;
    font-weight: 700;
    margin-bottom: 8px;
    color: #f1f5f9;
  }
  .synopsis-text {
    line-height: 1.5;
    color: var(--text-muted);
  }
  .info-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 12px 16px;
  }
  .info-item {
    display: flex;
    flex-direction: column;
    gap: 4px;
  }
  .info-label {
    font-size: 11px;
    text-transform: uppercase;
    font-weight: 600;
    letter-spacing: 0.05em;
    color: #94a3b8;
  }
  .info-val {
    font-size: 13px;
    color: #e2e8f0;
  }
  .comments-placeholder {
    padding: 24px;
    text-align: center;
    color: #94a3b8;
    font-size: 13px;
  }

  @media (max-width: 640px) {
    .hero-layout {
      grid-template-columns: 1fr;
    }
    .poster-wrap {
      max-height: 420px;
    }
    .cta-row {
      flex-direction: column;
    }
    .btn-watch,
    .btn-download {
      flex: 1 1 100%;
    }
  }
</style>

{% if not movie %}
<div class="detail-shell">
  <div class="card">
    <h2>Movie not found</h2>
    <p>The movie you are looking for is not available right now.</p>
  </div>
</div>
{% else %}
<div class="detail-shell">
  <div class="card hero-layout">
    <!-- Poster -->
    <div class="poster-wrap">
      {% if movie.poster_path %}
      <img src="{{ movie.poster_path }}" alt="{{ movie.title }}" />
      {% endif %}
    </div>

    <!-- Metadata + CTA -->
    <div class="meta-main">
      <div class="title">{{ movie.title }}</div>
      <div class="meta-line">
        {{ movie.year }} · {{ movie.quality }}
      </div>
      <div class="meta-line">
        Category: {{ movie.category }}
      </div>
      <div class="meta-line">
        Audio: {{ movie.audio }}
      </div>
      {% if movie.subtitles %}
      <div class="meta-line">
        Subtitles: {{ movie.subtitles }}
      </div>
      {% endif %}

      <div class="pill-row">
        {% if movie.is_multi_dubbed %}
        <span class="pill pill-accent">Multi audio</span>
        {% endif %}
        <span class="pill pill-secondary">HD ready</span>
        <span class="pill pill-secondary">Secure download</span>
      </div>

      <!-- UPDATED CTA BUTTONS - Now use verification routes -->
      <div class="cta-row">
        {% if movie.watch_url %}
        <a href="{{ url_for('movie_watch', movie_id=movie.id) }}" class="btn-watch">
          ▶ Watch now
        </a>
        {% endif %}
        {% if movie.download_url %}
        <a href="{{ url_for('movie_download', movie_id=movie.id) }}" class="btn-download">
          ⬇ Download
        </a>
        {% endif %}
      </div>
    </div>
  </div>

  <!-- Synopsis -->
  <div class="card">
    <div class="section-head">Synopsis</div>
    <div class="synopsis-text">
      Great movie with stunning visuals and engaging story.
    </div>
    <p style="margin-top: 8px; line-height: 1.5; color: var(--text-muted);">
      {{ movie.description or "Synopsis coming soon." }}
    </p>
  </div>

  <!-- Movie Info -->
  <div class="card">
    <div class="section-head">Movie Info</div>
    <div class="info-grid">
      <div class="info-item">
        <div class="info-label">Year</div>
        <div class="info-val">{{ movie.year }}</div>
      </div>
      <div class="info-item">
        <div class="info-label">Language</div>
        <div class="info-val">{{ movie.audio }}</div>
      </div>
      <div class="info-item">
        <div class="info-label">Quality</div>
        <div class="info-val">{{ movie.quality }}</div>
      </div>
      <div class="info-item">
        <div class="info-label">Category</div>
        <div class="info-val">{{ movie.category }}</div>
      </div>
    </div>
  </div>

  <!-- Comments -->
  <div class="card">
    <div class="section-head">Comments</div>
    <div class="comments-placeholder">
      Comments feature coming soon. Share this movie with your friends and
      collect their feedback in your channel.
    </div>
  </div>
</div>
{% endif %}
{% endblock %}
      
