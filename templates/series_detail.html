{% extends "base.html" %}

{% block content %}
<section class="mmc-main">
  <div class="mmc-layout">
    <!-- Left: hero / info -->
    <div class="mmc-left-column">

      <section class="detail-hero-card">
        <header class="detail-hero-header">
          <div>
            <h1 class="detail-hero-title">
              {{ series.title if series else "Series not found" }}
            </h1>
            {% if series %}
            <p class="detail-hero-sub">
              {{ series.year or "" }} · {{ series.primary_language or series.language or "Tamil" }} · Series
            </p>
            {% endif %}
          </div>
        </header>

        <div class="detail-hero-body">
          {% if series %}
          <p class="detail-hero-text">
            {{ series.description or "Binge-worthy series with engaging story and stunning visuals." }}
          </p>

          <!-- WATCH / DOWNLOAD BUTTONS -->
          <div style="margin-top:12px; display:flex; gap:10px; flex-wrap:wrap;">
            {% if primary_episode %}
              {% if primary_episode.watch_url %}
              <a href="{{ primary_episode.watch_url }}"
                 class="btn-main-primary" target="_blank" rel="noopener">
                ▶ Watch now
              </a>
              {% endif %}
              {% if primary_episode.download_url %}
              <a href="{{ primary_episode.download_url }}"
                 class="btn-main-secondary" target="_blank" rel="noopener">
                ⬇ Secure download
              </a>
              {% endif %}
            {% elif series.watch_url or series.download_url %}
              {% if series.watch_url %}
              <a href="{{ series.watch_url }}"
                 class="btn-main-primary" target="_blank" rel="noopener">
                ▶ Watch now
              </a>
              {% endif %}
              {% if series.download_url %}
              <a href="{{ series.download_url }}"
                 class="btn-main-secondary" target="_blank" rel="noopener">
                ⬇ Secure download
              </a>
              {% endif %}
            {% endif %}
          </div>

          {% else %}
          <p class="detail-hero-text">
            The series you are looking for is not available right now.
          </p>
          {% endif %}
        </div>
      </section>

      <!-- SYNOPSIS + INFO -->
      <section class="detail-info-card">
        <h2 class="detail-section-title">Synopsis</h2>
        <p class="detail-body-text">
          {% if series and series.description %}
            {{ series.description }}
          {% elif series %}
            Binge-worthy series with engaging story and stunning visuals.
          {% else %}
            The series you are looking for is not available right now.
          {% endif %}
        </p>

        <div class="detail-info-grid">
          <div>
            <div class="info-label">Year</div>
            <div class="info-value">
              {{ series.year if series and series.year else "—" }}
            </div>
          </div>
          <div>
            <div class="info-label">Primary</div>
            <div class="info-value">
              {{ series.primary_language or series.language or "Tamil" if series else "—" }}
            </div>
          </div>
          <div>
            <div class="info-label">Language</div>
            <div class="info-value">
              {{ series.language or "Tamil" if series else "—" }}
            </div>
          </div>
          <div>
            <div class="info-label">Episodes</div>
            <div class="info-value">
              {{ episodes_count if episodes_count is defined else 0 }}
            </div>
          </div>
        </div>
      </section>

      <!-- EPISODES BLOCK -->
      <section class="detail-info-card">
        <h2 class="detail-section-title">Episodes</h2>
        {% if episodes_count is defined and episodes_count > 0 %}
          <p class="detail-body-text">
            Choose an episode to watch or download.
          </p>
          <table class="episodes-table">
            <thead>
              <tr>
                <th>#</th>
                <th>Title</th>
                <th>Watch</th>
                <th>Download</th>
              </tr>
            </thead>
            <tbody>
              {% for e in episodes %}
              <tr>
                <td>{{ e.number }}</td>
                <td>{{ e.title }}</td>
                <td>
                  {% if e.watch_url %}
                    <a href="{{ e.watch_url }}" target="_blank" rel="noopener">Watch</a>
                  {% else %}
                    —
                  {% endif %}
                </td>
                <td>
                  {% if e.download_url %}
                    <a href="{{ e.download_url }}" target="_blank" rel="noopener">Download</a>
                  {% else %}
                    —
                  {% endif %}
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        {% else %}
          <p class="detail-body-text">
            Choose an episode to watch or download. Episodes will be added soon.
          </p>
        {% endif %}
      </section>

      <!-- COMMENTS NOTE -->
      <section class="detail-info-card">
        <h2 class="detail-section-title">Comments</h2>
        <p class="detail-body-text">
          Comments feature coming soon. Share this series with your friends
          and collect their feedback in your channel.
        </p>
      </section>
    </div>

    <!-- Right side can be kept for sidebar / recommendations if you already have it -->
  </div>
</section>
{% endblock %}
